---
layout: post
title: "250409 TIL"
subtitle: "게임 개발이 처음이어도 쉽게 배우는 모바일 게임 개발 2주차 정리"
date: 2024-04-09 09:00:00 +1200
author: codingnewwbie
---

오늘 배운 내용 정리
- UnityEngine
  - 2-1 기본 씬 구성
    어제 TIL 복습(windowLayout, GameObjct 생성, 애니메이션 적용, 스크립트 생성)
    
    Camera.main.ScreenToWorldPoint(Input.mousePosition) --> 입력장치의 마우스 커서 위치를 추적해서 게임상 위치로 변환
    
    의문 : 왜 게임상의 위치로 바꿔야 하지? 어차피 Scrren 위에 World 좌표가 있지 않나? Screen 쓰면 되는 거 아닌가? World 밖 좌표는 어차피 처리 안 될 거고
    
    해결 : 2D 게임만 만들고 있지만, Unity는 3차원 공간임. Screen에서 z값을 확정할 수 없음 + Screen은 (해상도 차이에 따른) 픽셀 단위, 유니티는 xyz World 단위라 단위 변환 필요.

  - 2-2 중력과 위치
    Rigidbody - 물리력 부여
    
    Collider - 충돌하는 물체 + 충돌할 물체 모두에게
    
    Prefab - 재사용을 위해 미리 아이템을 만들어 틀에 넣어둔 것
    
    GameManager에서 Prefab 생성 - public GameObject square 후 MakeSquare() {Instantiate(square)}

  - 2-3 중력과 위치
    using UnityEngine.UI; 추가하지 않으면 Text 에러
    
    time은 deltaTime 이용해서 계산 후 Text의 txt에 대입. float -> String 형 변환 시 toString();, "N2" = time의 소수점 2자리까지만 String으로 변환

  - 2-4 게임 종료 판넬
    그림자 효과(Add Component -> Shadow, 색깔 및 그림자의 x, y좌표 설정)
    
  - 2-5 게임 종료 로직
    싱글톤 설정(public static GameManager Instance;)
    Intance가 null일 때 Instance를 this로 설정하면 다른 인스턴스가 존재하면 해당 인스턴스를 무시됨. 이후 처리를 통해서 Instance가 무엇인지 등 나타낼 수 있음
    
  - 2-6 최고 점수
    데이터 보관 관련 - PlayerPrefs( = PlayerPrefabs), PlayerPrefs.set데이터형("키값", 저장할값) / get데이터형("키값") / HasKey("키값") - boolean반 / DeleteAll()
    문자열을 그대로 넣으면 오타 발생 및 이름 수정해야 하면 다 바꿔야 하는 문제가 생김 --> string 변수에 저장하는 편이 좋음.
    
  - 2-7 게임 종료 시 애니메이션 추가
    대상 GameObject에 새 애니메이션 클립 생성, 효과 주기
    
    프로젝트의(에셋의 애니메이션의) 애니메이션 컨트롤러 더블클릭(GameObject와 같은 이름으로 자동 생성), Scene 옆의 Animator 창에서 Parameters 추가.
    이름 및 형식 지정(이하 B)하고 Idle에서 B로 transition 생성(Idle에서 우클릭 -> Make transition)
    생성된 transition(화살표) 클릭 후  has exit time 적용 여부 확인(적용 안하면 즉시전환, 적용하면 딜레이 후 전환)

    게임에 적용.(GameManager에 Animation 추가해 Animation의 isDie가 실행되도록 값 넘겨주기)

    애니메이션 추가 적용 시 해당 Animation이 적용되도록 딜레이 후 Time.timeScale = 0f; 적용해야 함 --> Invoke 사용. timeScale 적용 코드 분리하여 함수 생성, Invoke("함수명", 딜레이시간)
    
  - 2-8 추가 숙제
    방법 2가지 생각남. 1. 보이지 않는 Ground 만들어서 부딪히면 제거, 2. square의 y값이 화면에 보이지 않을 정도로 낮아지면 제거.
    1번은 추가 Object 생성으로 인해 낭비일 것 같아 2번으로 시도.
    Start()에서 Square 생성했으니 Update()에서 해당 Square 계속 추적하다 y값이 Game창에 보이지 않으면 삭제하도록 Destroy 처리. 제대로 작동되는 것 확인
 
  - 2-9 전날 복습
    르탄이의 물방울에서 보완점이 2가지가 보였다.
    1. 게임 종료 시 르탄이가 계속 움직인다는 점 --> 학습 질문에 올라와 있음.
       요약하자면 물리 엔진을 적용하는 rigidbody를 사용 시 물리 연산 처리 함수인 FixedUpdate()가 실행되는데, timeScale = 0이면 FixedUpdate는 정지되나 1프레임마다 실행되는 Update()함수는 정지되지 않아 르탄이만 움직임.
       따라서 조건문을 걸어 timeScale이 0이면 Update함수를 실행시키지 않는 함수를 추가하면 르탄이도 멈
       
    2. 게임 시작하고 나서 벽에 부딪히지 않는 이상 르탄이 이미지와 움직이는 방향이 다르다는 점
       방법이 많을 것 같음(처음 시작 이미지를 바꾸거나, 조건문을 걸어 위치와 방향에 따라 renderer.flipX = true/false를 다르게 바꾸거나, Start() 함수에서 시작 이미지를 조절하거나 등)
       가장 간단한 방법인 Start()에 renderer.flipX = false; 추가해주니 원하는 대로 보임
